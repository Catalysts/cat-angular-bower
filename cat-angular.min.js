/*
 * Copyright 2014 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t){"use strict";t.cat={},angular.module("cat.controller.base.list",[]),angular.module("cat.controller.base.tabs",[]),angular.module("cat.controller.base.detail",["cat.controller.base.tabs"]),angular.module("cat.controller",["cat.controller.base.detail","cat.controller.base.list"]),angular.module("cat.template",["ui.bootstrap.tpls"]),angular.module("cat.service.api",[]),angular.module("cat.service.i18n",[]),angular.module("cat.service",["angularSpinner","ngRoute","cat.service.api","cat.service.i18n"]),angular.module("cat.directives.i18n",["cat.service.i18n"]),angular.module("cat.directives",["cat.directives.i18n","ui.select2","ui.bootstrap.pagination"]),angular.module("cat",["cat.service","cat.template","cat.directives","cat.controller"])}(window,document),function(t,e,n){"use strict";t.cat=t.cat||{},t.cat.FacetTerm=function(t){t===n&&(t={}),this.id=t.id,this.name=t.name,this.count=t.count},t.cat.Facet=function(e){e===n&&(e={}),this.name=e.name,this.terms=_.map(e.facets,function(e){return new t.cat.FacetTerm(e)})}}(window,document),function(t,e,n){"use strict";t.cat=t.cat||{},t.cat.SearchRequest=function(t){var e,i={page:1,size:100},r={},a={};t&&!_.isEmpty(t)&&(i.page=t.page||i.page,i.size=t.size||i.size,r.property=t.sort||r.property,r.isDesc=t.rev||r.isDesc,_.forEach(_.keys(t),function(e){e.indexOf("search.")>-1&&e.length>7&&(a[e.substring(7)]=t[e])}));var o=function(){return r.property?"sort="+r.property+":"+(r.isDesc===!0||"true"===r.isDesc?"desc":"asc"):""},c=function(){return"page="+(i.page?Math.max(0,i.page-1):0)+"&size="+i.size||100},s=function(t,e){return t?e?t+"&"+e:t:e},u=function(){return a&&!_.isEmpty(a)?$.param(a):""},l=function(){return _([c(),o(),u()]).reduce(s)};this.pagination=function(t){return t===n?i:i=t},this.sort=function(t){return t===n?r:r=t},this.search=function(t){return t===n?a:a=t},this.urlEncoded=function(){return e=l()},this.isDirty=function(){return e!==l()},this.setSearch=function(t){var e={};e.page=i.page,e.size=i.size,r.property&&(e.sort=r.property,e.rev=r.isDesc||!1),_.forEach(_.keys(a),function(t){e["search."+t]=a[t]}),t.search(e)}}}(window,document),function(t,e,n){"use strict";function i(t,e,i,r,a,o,c,s,u){t.detail=u.detail,t.editDetail=n,t.$fieldErrors={};var l=u.endpoint,d=u.baseUrl,f=u.templateUrls,p=u.Model;t.uiStack=s.generateFromConfig(u),s.push("new"===e.id?{title:"New",key:"cc.catalysts.general.new"}:{}),t.editTemplate=f.edit,_.isObject(f.view)?(t.mainViewTemplate=f.view.main,t.additionalViewTemplate=f.view.additional):t.mainViewTemplate=f.view,t.baseUrl=d,t.title=function(){var e=t.detail;return _.isUndefined(e)?"":e.breadcrumbTitle?e.breadcrumbTitle():e.name?e.name:e.id};var h=function(){s.replaceLast({title:t.title()})},g=function(){l.get(e.id).then(function(e){t.detail=e,h()})};t.reloadDetails=g,t.exists=!!e.id&&"new"!==e.id,t.add=function(){t.editDetail=new p,_.isFunction(t.editDetail.setParent)&&t.editDetail.setParent(u.parents[0])},t.edit=function(){t.editDetail=angular.copy(t.detail),_.isFunction(t.editDetail.setParent)&&t.editDetail.setParent(u.parents[0])},t.cancelEdit=function(){t.$broadcast("formReset"),t.exists?(t.editDetail=n,a.clearMessages(),t.$fieldErrors=n):r.history.back()},t.remove=function(){l.remove(t.detail.id).then(function(){if(_.isEmpty(t.uiStack))i.path(d);else{var e=t.uiStack[t.uiStack.length-1].url;i.path(e.substring(1,e.indexOf("?"))),i.search("tab",l.getEndpointName())}})},t.save=function(){l.save(t.editDetail).then(function(e){a.clearMessages(),t.$fieldErrors=n,t.exists?(t.editDetail=n,t.detail=e,h()):(t.$broadcast("formReset"),i.path(d+"/"+e.id))},function(e){if(!e.data.fieldErrors)return void(t.$fieldErrors=n);var i={};_.forEach(e.data.fieldErrors,function(t){i[t.field]=i[t.field]||[],i[t.field].push(t.message)}),t.$fieldErrors=i,t.$broadcast("fieldErrors",i)})},t.exists?_.isUndefined(t.detail)?g():h():_.isUndefined(t.detail)?t.add():t.edit(),t.baseTabsController=["$scope",function(t){o("CatBaseTabsController",{$scope:t,config:u})}];try{o(u.controller,{$scope:t,detail:u.detail,parents:u.parents,config:u})}catch(m){c.info("Couldn't instantiate controller with name "+u.controller)}}angular.module("cat.controller.base.detail").controller("CatBaseDetailController",i)}(window,document),function(){"use strict";function t(t,e,n,i,r){_.isUndefined(r.listData)?n.warn("No listData available!"):(this.titleKey="cc.catalysts.cat-breadcrumbs.entry."+r.listData.endpoint.getEndpointName(),i.set([{title:r.title,key:this.titleKey}]),t.listData=r.listData),this.title=r.title,this.searchProps=r.searchProps,this.config=r,this.getUrlForId=function(t){return"#"+r.baseUrl+"/"+t},this.getUrlForNewPage=function(){return this.getUrlForId("new")};try{e(r.controller,{$scope:t,listData:r.listData,config:r})}catch(a){n.info("Couldn't instantiate controller with name "+r.controller)}}angular.module("cat.controller.base.list").controller("CatBaseListController",["$scope","$controller","$log","catBreadcrumbsService","config",t])}(window,document),function(t){"use strict";function e(e,n,i,r,a){var o=a.endpoint;e.tabs=a.tabs,e.tabNames=_.map(a.tabs,"name"),e.activeTab={},e.activateTab=function(t){e.$broadcast("tab-"+t+"-active"),_.forEach(e.tabs,function(t){e.activeTab[t.name]=!1}),e.activeTab[t]=!0},e.selectTab=function(t){r.search("tab",t)};var c=function(t){return i.tab===t.name};e.$watchCollection(function(){return r.search()},function(t){_.isString(t.tab)&&e.activateTab(t.tab)}),e.getTabName=function(e){return t.cat.util.pluralize(t.cat.util.capitalize(e))},_.forEach(e.tabs,function(t){e.activeTab[t.name]=c(t)});for(var s=o.getEndpointName(),u=o.getEndpointName(),l=o;!_.isUndefined(l.parentEndpoint);){l=o.parentEndpoint;var d=l.getEndpointName();s=d+"/"+s,u=d+"-"+u}e.getTabTemplate=function(t){return s+"/"+t+"/"+u+"-"+t+"-list.tpl.html"};var f=function(e){return t.cat.util.capitalize(o.getEndpointName())+t.cat.util.capitalize(e.name)+"Controller"},p=function(t){return t.controller?t.controller:f(t)},h=0;e.tabController=["$scope","catListDataLoadingService",function(i,r){var o=e.tabs[h++],c=p(o);i.getSearchRequest=function(){return new t.cat.SearchRequest},i.getEndpoint=function(){return a.detail[o.name]},i.loadListData=function(){r.load(i.getEndpoint(),i.getSearchRequest()).then(function(t){i.listData=t})},i.$on("tab-"+o.name+"-active",function(){_.isUndefined(e.listData)&&i.loadListData()}),n(c,{$scope:i,detail:a.detail,parents:a.parents,config:a}),e.activeTab[o.name]===!0&&e.activateTab(o.name)}]}angular.module("cat.controller.base.tabs").controller("CatBaseTabsController",e)}(window,document),function(){"use strict";angular.module("cat").directive("catAutofocus",function(t){return{restrict:"A",link:function(e,n){t(function(){_.isUndefined(n.data("select2"))?n[0].focus():n.select2("open")},100)}}})}(window,document),function(){"use strict";angular.module("cat").directive("catCheckbox",function(){return{replace:!0,restrict:"E",scope:{checked:"="},link:function(t,e){e.addClass(t.checked?"glyphicon glyphicon-check":"glyphicon glyphicon-unchecked")}}})}(window,document),function(t){"use strict";angular.module("cat").directive("catConfirmClick",function(){return{restrict:"A",link:function(e,n,i){var r=i.catConfirmClick||"Are you sure?",a=i.catOnConfirm;n.bind("click",function(){t.confirm(r)&&e.$eval(a)})}}})}(window,document),function(t,e,n){"use strict";angular.module("cat").directive("catFacets",function(){function t(t){_.isUndefined(t.listData)&&(t.listData=t.$parent.listData)}function e(t){if(_.isUndefined(t.listData))throw new Error("listData was not defined and couldn't be found with default value");if(_.isUndefined(t.listData.facets))throw new Error("No facets are available within given listData")}return{replace:!0,restrict:"E",scope:{listData:"=?",names:"="},require:"^catPaginated",templateUrl:"template/cat-facets.tpl.html",link:function(n,i,r,a){t(n),e(n),n.catPaginatedController=a},controller:function(t){function e(e){return t.catPaginatedController.getSearchRequest().search(e)}t.isActive=function(e){return!!t.catPaginatedController.getSearch()[e.name]},t.facetName=function(e){return t.names!==n&&t.names[e.name]!==n?t.names[e.name]:e.name},t.facets={},t.facetChanged=function(n){var i=e(),r=t.facets[n.name];r?i[n.name]=r:delete i[n.name]},t.initFacets=function(){_.forEach(t.listData.facets,function(e){t.isActive(e)&&(t.facets[e.name]=t.catPaginatedController.getSearch()[e.name])})},t.facetSelectOptions={allowClear:!0}}}})}(window,document),function(){"use strict";angular.module("cat").directive("catFieldErrors",function(){return{replace:"true",restrict:"E",scope:{errors:"=",name:"@"},template:'<div class="label label-danger" ng-if="errors[name]"><ul><li ng-repeat="error in errors[name]">{{error}}</li></ul></div>'}})}(window,document),function(){"use strict";angular.module("cat.directives.i18n").directive("catI18n",["$log","$rootScope","catI18nService",function(t,e,n){function i(e,i){return e.key?void n.translate(e.key,e.params).then(function(t){i.text(t)},function(){}):void t.warn("No key was given for cat-i18n!")}return{restrict:"A",scope:{key:"@catI18n",params:"=?i18nParams",watchParams:"=?i18nWatchParams"},link:function(t,n){i(t,n),t.params&&t.watchParams===!0&&t.$watch("params",function(){i(t,n)},!0),e.$on("cat-i18n-refresh",function(){i(t,n)})}}}])}(window,document),function(){"use strict";angular.module("cat").directive("input",function(){return{require:"ngModel",restrict:"E",link:function(t,e,n,i){t.$on("fieldErrors",function(t,e){if(e&&n.id){var r=!e[n.id];i.$setValidity(n.id,r)}})}}}).directive("catInputGroup",function(){return{restrict:"A",transclude:!0,scope:{errors:"=",label:"@",name:"@"},link:function(t,e){e.addClass("form-group")},templateUrl:"template/cat-input.tpl.html"}})}(window,document),function(){"use strict";angular.module("cat").directive("catLoadMore",function(){return{replace:!0,restrict:"A",link:function(t,e,n){var i=parseInt(n.catLoadMore);if(t.$parent.elementsCount=t.$parent.elementsCount||i,t.$parent.elements=t.$parent.elements||[],t.$parent.elements.push(e),t.$parent.elements.length>t.$parent.elementsCount&&e.addClass("hidden"),!e.parent().next().length&&t.$parent.elements.length>t.$parent.elementsCount){var r=$('<a href="#">Show more</a>');r.on({click:function(){return t.$parent.elementsCount+=i,t.$parent.elements.length<=t.$parent.elementsCount&&r.addClass("hidden"),t.$parent.elements.forEach(function(e,n){n<t.$parent.elementsCount&&e.removeClass("hidden")}),!1}}),e.parent().after(r)}}}})}(window,document),function(){"use strict";angular.module("cat").directive("catMainMenu",["$mainMenu","$rootScope",function(t,e){return{restrict:"E",scope:{},link:function(n){n.menus=t.getMenus(),n.isVisible=function(t){var e=!1;return t.isMenu()||t.isGroup()?(_.forEach(t.getEntries(),function(t){e=e||n.isVisible(t)}),t.isMenu()&&_.forEach(t.getGroups(),function(t){e=e||n.isVisible(t)}),e):n.isAllowed(t)},n.isAllowed=function(t){var n=t.getOptions().rights;if(n){if(_.isArray(n)){for(var i=!0,r=0;r<n.length;r++)i=i&&e.isAllowed(n[r]);return i}return e.isAllowed(n)}return!0}},templateUrl:"template/cat-main-menu.tpl.html"}}])}(window,document),function(){"use strict";angular.module("cat").directive("catPaginated",function(t,e){var n="cc.catalysts.cat-paginated.search.prop";return{replace:!0,restrict:"E",transclude:!0,scope:{listData:"=?",syncLocation:"=?"},templateUrl:"template/cat-paginated.tpl.html",link:function(t,i,r){r.searchProps&&(t.searchProps=_.filter(r.searchProps.split(","),function(t){return!!t}),t.searchPropertyPlaceholders={},_.forEach(t.searchProps,function(i){t.searchPropertyPlaceholders[i]="Search by "+i,e.translate(n,{prop:i}).then(function(e){t.searchPropertyPlaceholders[i]=e})}))},controllerAs:"catPaginatedController",controller:function(t,e,n,i,r,a){function o(e){return function(n){t.paginationText[e]=n}}function c(){a.translate(f).then(o("previous")),a.translate(p).then(o("next")),a.translate(h).then(o("first")),a.translate(g).then(o("last"))}function s(){t.syncLocation!==!1&&(m.setSearch(e),e.replace())}var u=this,l=null,d=500,f="cc.catalysts.cat-paginated.pagination.previous",p="cc.catalysts.cat-paginated.pagination.next",h="cc.catalysts.cat-paginated.pagination.first",g="cc.catalysts.cat-paginated.pagination.last";if(_.isUndefined(t.listData)&&(t.listData=t.$parent.listData,_.isUndefined(t.listData)))throw new Error("listData was not defined and couldn't be found with default value");_.isUndefined(t.syncLocation)&&(t.syncLocation=_.isUndefined(t.$parent.detail)),t.paginationText={previous:"Previous",next:"Next",first:"First",last:"Last"},c(),i.$on("cat-i18n-refresh",function(){c()}),t.listData.search=t.listData.search||t.listData.searchRequest.search()||{};var m=t.listData.searchRequest,v=function(e){n.cancel(l),l=n(function(){m.isDirty()&&r.load(t.listData.endpoint,m).then(function(e){_.assign(t.listData,e)})},e||0)};t.$watch("listData.sort",function(e){e&&(console.log("broadcasting sort changed: "+angular.toJson(e)),t.$parent.$broadcast("SortChanged",e))},!0),t.$on("SearchChanged",function(t,e,n){w(e,n)}),t.$watch("listData.pagination",function(){s(),v()},!0);var w=function(e,n){m.search(e),s(),t.listData.pagination.page=1,v(n)},b=function(t){var e=m.search();_.assign(e,t),i.$broadcast("SearchChanged",e,d)};t.$watch("listData.search",b,!0),this.sort=function(e){m.sort(e),s(),t.listData.pagination.page=1,v()},this.getSearch=function(){return m.search()},this.getSearchRequest=function(){return m},t.$on("SortChanged",function(t,e){u.sort(e)})}}})}(window,document),function(t){"use strict";function e(t,e){e.addClass("form-control")}function n(t,e,n,i){var a=i.getConfig(t.config,t.options);if(_.isUndefined(a))throw new Error('At least one of "config" or "options" has to be specified');var o,c,s=a.search||function(t,e){return{"search.name":t,page:e}},u=a.filter||function(){return!0};if(_.isArray(a.endpoint))o=function(t){return t.success({elements:a.endpoint})},c=0;else if(_.isFunction(a.endpoint))o=a.endpoint,c=500;else if(_.isObject(a.endpoint))o=r(a.endpoint,a.sort),c=500;else{if(!_.isString(a.endpoint))return e.error("The given endpoint has to be one of the following types: array, object, string or function - but was "+typeof a.endpoint),void(t.elements=[]);var l=n[a.endpoint];if(!l)return e.error('No api endpoint "'+a.endpoint+'" defined'),void(t.elements=[]);o=r(l,a.sort),c=500}t.selectOptions=_.assign({placeholder:" ",minimumInputLength:0,adaptDropdownCssClass:function(t){return _.contains(["ng-valid","ng-invalid","ng-pristine","ng-dirty"],t)?t:null},ajax:{data:s,quietMillis:c,transport:o,results:function(t,e){var n=(e*a.size||100)<t.totalCount;return{results:_.filter(t.elements,u),more:n}}},formatResult:function(t){return t.name},formatSelection:function(t){return t.name}},a["ui-select2"])}function i(){return{restrict:"EA",replace:!0,priority:1,scope:{options:"=?",id:"@",config:"@?"},link:e,controller:n,template:'<input type="text" ui-select2="selectOptions">'}}var r=function(e,n){return function(i){var r=new t.cat.SearchRequest(i.data);return r.sort(n||{property:"name",isDesc:!1}),e.list(r).then(i.success)}};angular.module("cat.directives").directive("catSelect",i)}(window,document),function(){"use strict";angular.module("cat").directive("catSortable",function(t){return{restrict:"AC",require:"^catPaginated",link:function(e,n,i,r){var a=n.text(),o=i.catSortable||a.toLowerCase().trim();e.sort=e.listData.searchRequest.sort(),e.catPaginatedController=r;var c="glyphicon-sort-by-attributes";i.sortMode&&("numeric"===i.sortMode?c="glyphicon-sort-by-order":"alphabet"===i.sortMode&&(c="glyphicon-sort-by-alphabet")),n.text(""),n.append(t('<a class="sort-link" href="" ng-click="toggleSort(\''+o+'\')" cat-i18n="cc.catalysts.cat-sortable.sort.'+o+'">'+a+' <span class="glyphicon" ng-class="{\''+c+"': sort.property == '"+o+"' && !sort.isDesc, '"+c+"-alt': sort.property == '"+o+"' && sort.isDesc}\"></span></a>")(e))},controller:function(t){t.toggleSort=function(e){t.sort.property===e?t.sort.isDesc=!t.sort.isDesc:(t.sort.property=e,t.sort.isDesc=!1),t.catPaginatedController.sort(t.sort)},t.$on("SortChanged",function(e,n){t.sort=n})}}})}(window,document),function(t){"use strict";angular.module("cat").directive("form",["$timeout",function(e){return{restrict:"E",scope:!0,require:"form",link:function(n,i,r,a){var o=r.eocsWarnOnNavIfDirty||"You have unsaved changes. Leave the page?";e(function(){a.$setPristine(!0)},50),n.$on("formReset",function(){a.$setPristine(!0)}),n.$on("formDirty",function(){a.$setDirty(!0)}),n.$on("$locationChangeStart",function(e){a.$dirty&&(t.confirm(o)||e.preventDefault())}),$(t).on("beforeunload",function(){return a.$dirty?o:void 0}),n.$on("$destroy",function(){$(t).unbind("beforeunload")})}}}])}(window,document),function(){"use strict";angular.module("cat").directive("numbersOnly",function(){return{require:"ngModel",link:function(t,e,n,i){i.$parsers.push(function(t){if(!t)return"";var e="[^0-9]";n.hasOwnProperty("allowFraction")&&(e="[^0-9,.]");var r=t.replace(new RegExp(e,"g"),"");return r!==t&&(i.$setViewValue(r),i.$render()),r})}}})}(window,document),function(t){"use strict";t.cat.i18n=t.cat.i18n||{},t.cat.i18n.de=t.cat.i18n.de||{},_.assign(t.cat.i18n.de,{"cc.catalysts.cat-paginated.itemsFound":"{{count}} Einträge gefunden. Einträge {{firstResult}}-{{lastResult}}","cc.catalysts.cat-paginated.noItemsFound":"Keine Einträge gefunden","cc.catalysts.general.new":"Neu"})}(window,document),function(t){"use strict";t.cat.i18n=t.cat.i18n||{},t.cat.i18n.en=t.cat.i18n.en||{},_.assign(t.cat.i18n.en,{"cc.catalysts.cat-paginated.itemsFound":"{{count}} entries found. Entries {{firstResult}}-{{lastResult}}","cc.catalysts.cat-paginated.noItemsFound":"No entries found","cc.catalysts.general.new":"New"})}(window,document),function(t,e,n){"use strict";angular.module("cat").filter("replaceText",function(){return function(t,e,i,r){return e===n&&(e="\n"),i===n&&(i="g"),r===n&&(r=", "),t?String(t).replace(new RegExp(e,i),r):t}})}(window,document),function(t){"use strict";function e(n,i,r){var a=this,o=i.name,c=n+(i.config.url||i.name),s=i.config.model,u=i.children,l=_.memoize(function(t){var n=c+"/"+t+"/",i={};return _.forEach(_.keys(u),function(o){i[o]=new e(n,u[o],r),i[o].parentEndpoint=a,i[o].parentId=t,i[o].parentInfo=function(){return a.info(t)}}),i}),d=function(t){var e=new s(t);return _.merge(e,l(e.id))},f=function(t){var e=l(t.id);return _.forEach(_.keys(e),function(e){delete t[e]}),t},p=function(e){return e&&e instanceof t.cat.SearchRequest?"?"+e.urlEncoded():""};this.res=function(t){return l(t)},this.getEndpointUrl=function(){return c},this.getEndpointName=function(){return o},this.list=function(e){return r.get(c+p(e)).then(function(e){if(e.data.totalCount||0===e.data.totalCount){var n=[];e.data.facets&&(n=_.map(e.data.facets,function(e){return new t.cat.Facet(e)}));var i={totalCount:e.data.totalCount,facets:n,elements:_.map(e.data.elements,function(t){return d(t)})};return delete e.data.totalCount,delete e.data.elements,delete e.data.facets,_.assign(i,e.data)}return _.map(e.data,function(t){return d(t)})})},this.all=function(){return r.get(c+"/all").then(function(t){return _.map(t.data,function(t){return d(t)})})},this.get=function(t){return r.get(c+"/"+t).then(function(t){return d(t.data)})},this.info=function(t){return r.get(c+"/"+t+"?info").then(function(t){return t.data})},this.save=function(t){return t.id?r.put(c+"/"+t.id,f(t)).then(function(t){return d(t.data)}):r.post(c,f(t)).then(function(t){return d(t.data)})},this.remove=function(t){return r({method:"DELETE",url:c+"/"+t})},this.custom={},this.custom.get=function(t,e){return r.get([c,t].join("/")+p(e))},this.custom.post=function(t,e){return r.post([c,t].join("/"),e)},this.custom.put=function(t,e){return r.put([c,t].join("/"),e)}}function n(t,e){var i=this;if(this.config=e||{},this.children={},this.name=t,this.child=function(t,e){return _.isUndefined(e)||(this.children[t]=new n(t,e),this.children[t].parent=this),this.children[t]},!_.isUndefined(this.config.children)){var r=this.config.children;delete this.config.children,_.forEach(_.keys(r),function(t){i.child(t,r[t])})}}function i(){var t="/api/";this.endpoint=function(t,e){return _.isUndefined(e)||(r[t]=new n(t,e)),r[t]},this.$get=["$http",function(n){var i={};return _.forEach(_.keys(r),function(a){i[a]=new e(t,r[a],n)}),i}]}var r={};angular.module("cat.service.api").provider("catApiService",i),angular.module("cat.service.api").provider("$api",i)}(window,document),function(t){"use strict";function e(){function e(t){return t.charAt(0).toUpperCase()+t.substring(1)}function n(t,e){return _.initial(t.split("/"),e).join("/")}var i=[],r=this;this.clear=function(){i=[]},this.set=function(t){i=t},this.get=function(){return i},this.addFirst=function(t){i.unshift(t)},this.removeFirst=function(){return i.shift()},this.push=function(t){i.push(t)},this.pop=function(){return i.pop()},this.length=function(){return i.length},this.replaceLast=function(t){i[i.length-1]=t},this.generateFromConfig=function(i){r.clear();var a=[];if(_.isUndefined(i.endpoint.parentEndpoint))r.push({title:e(t.cat.util.pluralize(i.endpoint.getEndpointName())),key:"cc.catalysts.cat-breadcrumbs.entry."+i.endpoint.getEndpointName(),url:"#"+i.baseUrl});else for(var o=i.endpoint,c=o.parentEndpoint,s=i.baseUrl,u=0;!_.isUndefined(c);){var l=i.parents[u++];s=n(s,1);var d={url:"#"+s+"?tab="+o.getEndpointName(),title:l.name};a.unshift(d),r.addFirst(d),s=n(s,1);var f={title:e(t.cat.util.pluralize(c.getEndpointName())),key:"cc.catalysts.cat-breadcrumbs.entry."+i.endpoint.getEndpointName(),url:"#"+s};r.addFirst(f),o=c,c=o.parentEndpoint}return a}}angular.module("cat.service").service("catBreadcrumbsService",e),angular.module("cat.service").service("$breadcrumbs",e)}(window,document),function(t,e,n){"use strict";function i(t,e,i){this.getLanguageOfLocale=function(t){return _.isUndefined(t)?n:-1!==t.indexOf("-")?t.split("-")[0]:t},this.getCurrentLocale=function(){return e.id},this.getDefaultLocale=function(){return i}}angular.module("cat.service.i18n").constant("CAT_I18N_DEFAULT_LOCALE","de").service("catI18nLocaleService",["$q","$locale","CAT_I18N_DEFAULT_LOCALE",i])}(window,document),function(t){"use strict";function e(e,n,i){function r(t){return t||n.getDefaultLocale()}function a(e){var o=r(e),c=t.cat.i18n[o];return _.isUndefined(c)&&(c=a(n.getLanguageOfLocale(o))),o!==i&&_.isUndefined(c)&&(c=a(i)),c}this.getMessages=function(t){return e.when(a(t))},this.getMessage=function(t,n){var i=a(n);return _.isUndefined(i)||_.isUndefined(i[t])?e.reject("No message found for key '"+t+"' and the given locale '"+r(n)+"'"):e.when(i[t])},this.hasMessage=function(t,n){var i=a(n);return e.when(!_.isUndefined(i)&&!_.isUndefined(i[t]))}}angular.module("cat.service.i18n").service("catI18nMessageSourceService",["$q","catI18nLocaleService","CAT_I18N_DEFAULT_LOCALE",e])}(window,document),function(){"use strict";function t(t,e,n,i){var r=this;this.translate=function(a,o,c){var s=t.defer(),u=o;return _.isArray(o)&&o.forEach(function(t,e){u["p"+e]=t}),r.canTranslate(a,c).then(function(t){if(t)n.getMessage(a,c).then(function(t){try{s.resolve(i(t,u))}catch(n){e.warn(n),s.reject(n)}},function(t){e.warn(t),s.reject(t)});else{var r="No translation for key '"+a+"' available!";e.warn(r),s.reject(r)}},s.reject),s.promise},this.canTranslate=function(e,i){var r=t.defer();return n.getMessages(i).then(function(t){r.resolve(!_.isUndefined(t)&&!_.isUndefined(t[e]))},function(e){t.reject(e)}),r.promise}}angular.module("cat.service.i18n").value("catI18nMessageParameterResolver",function(t,e){return _.template(t,e||{},{interpolate:/{{([\s\S\d]+?)}}/g})}).service("catI18nService",["$q","$log","catI18nMessageSourceService","catI18nMessageParameterResolver",t])}(window,document),function(t){"use strict";angular.module("cat.service").factory("catListDataLoadingService",["catApiService","$route","$q",function(e,n,i){var r=function(t,e){var n=i.defer();return t.list(e).then(function(i){var r=e.pagination(),a={count:i.totalCount,collection:i.elements,pagination:r,firstResult:(r.page-1)*r.size+1,lastResult:Math.min(r.page*r.size,i.totalCount),facets:i.facets,isSinglePageList:i.totalCount<=r.size,endpoint:t,searchRequest:e};delete i.totalCount,delete i.elements,delete i.facets,n.resolve(_.assign(a,i))},function(t){n.reject(t)}),n.promise},a=function(i,a){var o=new t.cat.SearchRequest(n.current.params);return a||(a={property:"name",isDesc:!1}),a&&!n.current.params.sort&&o.sort(a),r(e[i],o)};return{load:r,resolve:a}}])}(window,document),function(t){"use strict";function e(e){var n=[];this.listAndDetailRoute=function(i,r,a){n.push(r);var o=i+"/"+t.cat.util.pluralize(r.toLowerCase());a&&a.url&&(o=i+"/"+a.url||o);var c=a?a.list:{},s=a?a.details:{},u={name:r};e.when(o,t.cat.util.route.list(_.assign({},u,c))).when(o+"/:id",t.cat.util.route.detail(_.assign({},u,s)))},this.$get=function(){return n}}angular.module("cat.service").provider("catRouteService",e)}(window,document),function(t,e,n){"use strict";function i(t,e){return _.assign(t,e,function(t,e){return _.isObject(t)&&_.isObject(e)?i(t,e):e})}function r(t){this.getConfig=function(e,r){var a=t[e];return _.isUndefined(a)&&_.isUndefined(r)?n:i(_.clone(a)||{},r)}}function a(){var t={};this.config=function(e,n){return _.isUndefined(n)||(t[e]=n),t[e]},this.$get=function(){return new r(t)}}angular.module("cat.service").provider("catSelectConfigService",a)}(window,document),function(t){"use strict";function e(e,n){var i=[],r=[];this.listAndDetailView=function(a,o,c){var s=o.toLowerCase(),u=t.cat.util.pluralize(s);c&&(u=c.url||u);var l={model:t.cat.util.defaultModelResolver(o),url:u};c&&(l=_.assign(l,c.endpoint)),i.push(o),r.push(s),n.endpoint(o.toLowerCase(),l),e.listAndDetailRoute(a,o,c)},this.$get=function(){return{views:i,endpoints:r}}}angular.module("cat.service").provider("catViewService",e)}(window,document),function(){"use strict";angular.module("cat.service").factory("errorHttpInterceptor",function(t,e,n){return{request:function(t){return n.start(),t},requestError:function(e){return n.stop(),t.reject(e)},response:function(t){return n.stop(),t},responseError:function(i){if(n.stop(),e.clearMessages("error"),i.data.error){var r="["+i.status+" - "+i.statusText+"] "+i.data.error;i.data.cause&&(r+="\n"+i.data.cause),e.addMessage("error",r)}return i.data.globalErrors&&e.addMessages("error",i.data.globalErrors),t.reject(i)}}}).config(function(t){t.interceptors.push("errorHttpInterceptor")})}(window,document),function(t,e,n){"use strict";angular.module("cat.service").factory("loadingService",function(t,e,i){var r,a,o,c=50,s=200,u=0,l=function(){u||a||(o&&(i.cancel(o),o=n),a=i(function(){e.spin("loading-spinner"),t.loading=!0,r=(new Date).getTime()},c)),u++},d=function(){if(u--,!u&&!o){a&&(i.cancel(a),a=n);var l=(new Date).getTime(),d=c+Math.max(s-(l-r),0);o=i(function(){e.stop("loading-spinner"),t.loading=!1},d)}};return t.$on("$routeChangeStart",function(){l()}),t.$on("$routeChangeSuccess",function(){d()}),t.$on("$routeChangeError",function(){d()}),{start:l,stop:d}})}(window,document),function(t,e,n){"use strict";function i(t,e,n){this.id=t,this.completeId=n.completeId+"."+this.id;var i=e;this.getOptions=function(){return i},this.isGroup=function(){return!1},this.isMenu=function(){return!1}}function r(t,e,n){var r=this;this.id=t,this.completeId=n.completeId+"."+this.id;var a=[],o=e;this.addMenuEntry=function(t,e){a.push(new i(t,e,r))},this.getOptions=function(){return o},this.getEntries=function(){return _.sortBy(a,function(t){return t.getOptions().sortOrder||1e4})},this.isGroup=function(){return!0},this.isMenu=function(){return!1}}function a(t,e){var n=this;this.id=t,this.completeId=this.id;var a=[],o={},c=e;this.addMenuGroup=function(t,e){o[t]=new r(t,e,n)},this.addMenuEntry=function(t,e,r){_.isUndefined(t)?a.push(new i(e,r,n)):o[t].addMenuEntry(e,r)},this.getGroups=function(){return _.sortBy(_.map(o,function(t){return t}),function(t){return t.getOptions().sortOrder||1e4})},this.getEntries=function(t){return _.isUndefined(t)?_.sortBy(a,function(t){return t.getOptions().sortOrder||1e4}):o[t].getEntries()},this.getFlattened=function(){return _.flatten([a,_.map(this.getGroups(),function(t){return[t,t.getEntries()]})])},this.isMenu=function(){return!0},this.isGroup=function(){return!1},this.getOptions=function(){return c}}function o(t,e){this.id=t;var n={},i=e;this.addMenu=function(t,e){n[t]=new a(t,e)},this.addMenuGroup=function(t,e,i){n[t].addMenuGroup(e,i)},this.addMenuEntry=function(t,e,i,r){n[t].addMenuEntry(e,i,r)},this.getMenus=function(){return _.map(n,function(t){return t})},this.getOptions=function(){return i}}function c(){var t=new o("main.menu",{}),e=[],i=[],r=[];this.menu=function(t,n){e.push({menuId:t,options:n})},this.menuGroup=function(t,e,n){i.push({menuId:t,groupId:e,options:n})},this.menuEntry=function(t,e,i,a){_.isUndefined(a)&&(a=i,i=e,e=n),r.push({menuId:t,groupId:e,entryId:i,options:a})},this.$get=function(){return _.forEach(e,function(e){t.addMenu(e.menuId,e.options)}),_.forEach(i,function(e){t.addMenuGroup(e.menuId,e.groupId,e.options)}),_.forEach(r,function(e){t.addMenuEntry(e.menuId,e.groupId,e.entryId,e.options)}),t}}angular.module("cat.service").provider("$mainMenu",c)}(window,document),function(){"use strict";angular.module("cat.service").service("$globalMessages",function(t){var e={},n=this;this.getMessages=function(t){return t?e[t]:[]},this.hasMessages=function(t){return t?!!e[t]&&0!==e[t].length:!1},this.clearMessages=function(t){return t?void(e[t]=[]):void(e={})},this.addMessage=function(t,i){t&&(e[t]||n.clearMessages(t),e[t].push(i))},this.addMessages=function(t,e){t&&_.forEach(e,function(e){n.addMessage(t,e)})},this.setMessages=function(t,e){t&&(n.clearMessages(t),e&&n.addMessages(t,e))},t.$on("$routeChangeSuccess",function(){n.clearMessages()})})}(window,document),function(t){"use strict";t.cat.util=t.cat.util||{},t.cat.util.pluralize=function(t){if(_.isUndefined(t)||0===t.length)return"";var e=t[t.length-1];switch(e){case"y":return t.substring(0,t.length-1)+"ies";case"s":return t+"es";default:return t+"s"}},t.cat.util.capitalize=function(t){return _.isUndefined(t)||0===t.length?"":t.substring(0,1).toUpperCase()+t.substring(1,t.length)}}(window,document),function(t){"use strict";t.cat.util=t.cat.util||{},t.cat.models=t.cat.models||{},t.cat.util.defaultModelResolver=function(e){return t.cat.models[e]};var e=function(t){return t?t.toLowerCase():""},n=function(t,e,n){return _.isUndefined(e)&&(e=t.current.originalPath,0!==_.keys(t.current.pathParams).length&&(e=e.substring(0,e.lastIndexOf("/"))),_.isArray(n)&&_.forEach(n,function(n){var i=n+"Id";e=e.replace(":"+i,t.current.params[i])})),e},i=function(i){function r(t){return t.resolve(i.endpoint||o,i.defaultSort)}function a(e,a,c){var s=e.defer(),u={controller:i.controller||i.name+"Controller",baseUrl:n(a,i.baseUrl),title:t.cat.util.pluralize(i.name),searchProps:i.searchProps||t.cat.util.defaultListSearchProps,listTemplateUrl:i.listTemplateUrl||o+"/"+o+"-list.tpl.html"};return r(c).then(function(t){u.listData=t,s.resolve(u)}),s.promise}var o=e(i.name);return{reloadOnSearch:!1,controller:"CatBaseListController",controllerAs:"catBaseListController",templateUrl:i.templateUrl||"template/cat-base-list.tpl.html",resolve:{config:a}}},r=function(i){function r(t,e){var n=e[s];return _.isArray(u)&&(_.forEach(u,function(i,r){var a;a=0===r?e[i]:n[i],n=a.res(t.current.params[i+"Id"])}),n=n[s]),n}function a(t,e,n){var i,r=t.current.params.id;return i="new"===r?e.when(new l):n.get(r)}function o(t,e,o){var s=e.defer(),d=r(t,o),f=n(t,i.baseUrl,u),g={controller:i.controller||i.name+"DetailsController",endpoint:d,Model:l,templateUrls:h,tabs:p,baseUrl:f},m=a(t,e,d);m.then(function(t){g.detail=t});var v=c(e,d);return v.then(function(t){g.parents=t}),e.all([m,v]).then(function(){s.resolve(g)},function(t){s.reject(t)}),s.promise}function c(t,e){if(_.isUndefined(e)||_.isUndefined(e.parentInfo))return t.when([]);var n=t.defer(),i=[];return e.parentInfo().then(function(r){i.push(r),c(t,e.parentEndpoint).then(function(t){i.push(t),i=_.flatten(i),n.resolve(i)
},function(t){n.reject(t)})},function(t){n.reject(t)}),n.promise}var s,u;_.isString(i.endpoint)?s=i.endpoint:_.isObject(i.endpoint)?(u=i.endpoint.parents,s=i.endpoint.name):s=e(i.name);var l=i.model||t.cat.util.defaultModelResolver(i.name),d="",f="";_.isArray(u)&&_.forEach(u,function(t){d+=t,d+="/",f+=t,f+="-"});var p,h={edit:d+s+"/"+f+s+"-details-edit.tpl.html",view:d+s+"/"+f+s+"-details-view.tpl.html"};return i.additionalViewTemplate===!0?h.view={main:h.view,additional:d+s+"/"+f+s+"-additional-details-view.tpl.html"}:"tabs"===i.additionalViewTemplate&&(h.view={main:h.view,additional:"template/cat-base-additional-details-tabs-view.tpl.html"},p=i.additionalViewTemplateTabs),{templateUrl:i.templateUrl||"template/cat-base-detail.tpl.html",controller:"CatBaseDetailController",reloadOnSearch:i.reloadOnSearch,resolve:{config:function(t,e,n){return o(t,e,n)}}}};t.cat.util.route={list:i,detail:r}}(window,document);